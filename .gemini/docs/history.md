## 2026-02-13 (Smart Seeding Refactor & Support UI 100% Completion)

- **Smart Seeding (Spec 032):**
    - **Refactored `SeederService`** from a monolithic class into a modular coordinator using domain-specific seeders (`IamSeeder`, `PresentationSeeder`, `ProcurementSeeder`, `CulinarySeeder`).
    - Implemented **External Synchronization** in `CulinarySeeder`. When seeding sample data, the system now automatically pushes the culinary catalog (Categories & Products) to the **Square Sandbox** if an integration is configured.
    - Standardized seeder interfaces across the API to ensure 100% adherence to DDD principles.
    - Created **Spec 032** documentation to codify the seeding architecture and sync patterns.
- **Support & Feedback UI (Spec 022) - 100% Implementation:**
    - Completed the missing UI components in `@sous/features/support`: `SupportForm`, `FeedbackModal`, and `SupportCategoryCard`.
    - Implemented **Next.js Server Actions** (`submitFeedbackAction`) for secure, server-side feedback submission.
    - Launched the `/support` page in the web app, providing a centralized hub for bug reports, feature requests, and documentation access.
    - Integrated a persistent **Feedback Trigger** into the global admin layout sidebar for instant accessibility.
    - Verified full metadata capture (app version, user agent, URL, etc.) for every support report.
- **Branding Lab Enhancements (Spec 005):**
    - Upgraded the **Atelier** (Branding Lab) with a direct "Save to Workspace" feature that hits a local API in development to update `branding.config.json`.
    - Added a **"Paste Configuration"** import field to allow rapid design synchronization and external feedback integration.
- **Design System Expansion:**
    - Added the `Textarea` component to `@sous/ui` to ensure consistent form styling across the platform.
- **Unified Authorization & OAuth2 (ADR 048 / Spec 037):**
    - Implemented **Effective Scopes** calculation logic merging User Roles and Organization Plans.
    - Created a universal **`ScopesGuard`** that enforces the intersection of allowed scopes and token-specific grants.
    - Built a full **OAuth2 Provider** with `/authorize` and `/token` endpoints, enabling 3rd-party integrations.
    - Launched the **Developer Portal** in the web dashboard for client registration and secret management.
- **Payment & Billing Orchestration (Spec 026):**
    - Built a provider-agnostic **Payment Driver Engine** with a production-ready `StripeDriver`.
    - Implemented the **Registration-to-Checkout** flow, enforcing a `pending_payment` state for new organizations.
    - Created a polished **Checkout UI** with tiered plan selection and confirmation emails via Resend.
    - Added a **SuperAdmin Platform Settings** area for global configuration like `support_email`.
- **POS Financial Engine & Reliability (Spec 027):**
    - Established the **POS Ledger** and **Financial Transaction** schemas for high-integrity accounting.
    - Implemented a Redis-backed **`IdempotencyInterceptor`** to prevent double-charging and duplicate orders.
    - Built the foundation for **Offline Sync** in the Client SDK, featuring a "Store and Forward" queue for mutations.
- **Salesman Attribution System (Spec 030):**
    - Expanded IAM with the **Salesman Role** and attribution tracking on organizations and invitations.
    - Launched the **Salesman Portal** featuring commission tracking and "Support Access" (impersonation) for troubleshooting.
    - Built a background worker for automated commission calculation.
- **Edge Fleet Management (Spec 036):**
    - Integrated **mDNS Discovery** into the Edge Node start sequence, allowing local discovery via `sous.local`.
    - Implemented a **Local Fallback Switch** in the Client SDK to prioritize Edge Node traffic during cloud outages.

## 2026-02-13 (DB Scalability, Support System, and CLI Expansion)

- **Database Scalability (Spec 035):**
    - Implemented **Reader/Writer separation** in `DatabaseService`. All write operations and transactions now target the primary instance, while reads are distributed to a reader pool.
    - Added automated fallback to the writer instance if a reader URL is not provided.
    - Updated all core services to utilize `db` for writes and `readDb` for performance-sensitive reads.
- **Production-Ready Support & Feedback (Spec 022):**
    - Built a centralized `SupportService` in the API that bridges user feedback to **GitHub Issues** via Octokit.
    - Implemented a dual-notification system: the internal team receives a detailed alert, and the user receives a brand-aligned confirmation email via **BullMQ/Resend**.
    - Launched the `sous feedback` CLI command, providing a frictionless way for developers and users to report bugs or request features.
- **CLI Expansion & Auth (Spec 021):**
    - Implemented a robust local configuration store in `~/.sous/config.json`.
    - Added `sous context login`, `logout`, and `switch-org` commands to manage developer sessions.
    - Built a root-aware **Scaffolding Engine** (`sous generate domain`, `sous generate feature`, `sous generate ui`) to enforce Monorepo standards and DDD structure.
    - Silenced excessive OpenTelemetry and HyperDX logs in the CLI to ensure a clean developer experience.
- **Pricing & Usage Enforcement (Spec 024):**
    - Implemented `PlanService` for multi-tenant subscription level resolution.
    - Created `ScopesGuard` and `UsageGuard` to enforce plan-based limits and feature access across the API.
    - Integrated usage metrics tracking into the core request lifecycle.
- **Recipe Cook Mode Polish:**
    - Added **Smart Ingredient Highlighting**: mentions of ingredients in instructions are now interactive links that reveal weights and prep details.
    - Implemented **Persistent Cook Notes**: users can now save session-specific observations that persist across cook sessions for the same recipe.
- **Infrastructure & Stability:**
    - Resolved critical Webpack bundling failures in `@sous/web` by aliasing `@hyperdx/node-opentelemetry` for browser builds.
    - Fixed CLI argument parsing errors where flags like `--help` were being ignored by the NestJS CLI wrapper.
    - Synchronized all new schemas (`billing`, `support`, `plans`) via `db:push`.

## 2026-02-13 (User Management & Auth Expansion)

- **Social Logins (OAuth2):**
    - Expanded `AuthController` and `AuthService` to support **GitHub** and **Facebook** authentication alongside Google.
    - Implemented a unified `validateSocialUser` logic that automatically links social IDs to existing accounts via email.
    - Updated `users` schema to include `githubId` and `facebookId` with unique constraints.
- **Full Team Management UI:**
    - Established `UsersController` and `UsersModule` in the API to manage organization members.
    - Implemented `TeamList` component in `@sous/features` allowing managers to view active members, toggle roles (Admin/Member), and remove users from the organization.
    - Added role-based safeguards to prevent users from changing their own roles or removing themselves.
    - Integrated `TeamList` and `InvitationManager` into a unified **Team Management** dashboard in the web app.
- **Sync Config & CLI Injection Strategy:**
    - Researched a refactor for `@sous/config` (**ADR 057**) to move from brittle async runtime resolution to a strictly synchronous pattern.
    - Designed a **CLI Injector (Spec 034)** within `@sous/cli` that fetches secrets from Infisical and injects them into any subprocess, ensuring "Config-on-Line-1" availability.
    - Established mandatory environment wrapping for all scripts, eliminating the need for manual `.env` management or direct Infisical calls during debugging.
- **Unified Observability & Metrics Dashboard:**
    - Researched a consolidated monitoring strategy (**ADR 056**) using **OpenTelemetry (OTel)** to pipe logs, errors, and traces into **HyperDX**.
    - Designed an internal **"Control Plane" (Spec 033)** to visualize infrastructure usage (Free Tier tracking), code analytics (Tech Debt/Dependencies), and "Life of the System" events.
    - Established a "Lead with Metrics" approach to proactively monitor bottlenecks like slow DB queries and cold starts directly within the Sous SuperAdmin dashboard.
- **Unified Asset Pipeline (The Asset Forge):**
    - Established a centralized brand asset strategy (**ADR 054**) to ensure 100% uniformity across Web, Capacitor, WearOS, and Desktop targets.
    - Designed the **Sous Asset Forge (Spec 031)**, a CLI-driven engine that injects branding tokens into master SVGs and rasterizes them using Sharp.
    - Standardized on **Sovereign Templates** with LOD (Level of Detail) support for micro-icons vs. high-res splashes.
    - Integrated an "Asset Audit" mandate for the Branding Lab, ensuring build artifacts are visually verified in the documentation hub.
- **Smart Seeding & DDD Schema Standards:**
    - Established decentralized seeding standards (**ADR 055**) where domain-specific logic is encapsulated in `[domain].seed.ts` files.
    - Designed a "Smart Seed" architecture (**Spec 032**) capable of orchestrating both internal Drizzle updates and external POS sandbox (Square) synchronization.
    - Mandated strict DDD folder structures for all upcoming domains, ensuring schemas and seeders are co-located with their respective services.
- **Payment & Billing Orchestration Strategy:**
    - Defined a provider-agnostic billing architecture (**ADR 049**) using a Driver/Adapter pattern to support Stripe, **CardConnect**, and custom merchants.
    - Scoped the registration-to-activation workflow, including `PENDING_PAYMENT` states and automated provisioning.
    - Detailed the foundations for **POS Terminal hardware integration** via unified Payment Intent endpoints.
    - Established **Spec 026** for the database schema, driver interfaces, and multi-tenant notification engine.
- **Sales Attribution & Commission Engine:**
    - Established the **Salesman Role** (**ADR 053**) to sit between SuperAdmin and TenantAdmin, enabling a professional sales force.
    - Designed a **Commission Ledger (Spec 030)** for automated recurring RevShare tracking and payouts.
    - Integrated attribution into the invitation and registration flows via unique salesman IDs.
- **Scalability & Infrastructure Prep:**
    - Defined a "Zero-Cost" architecture strategy (**ADR 058**) to prepare for future sharding via mandatory `organization_id` partition keys and UUIDs.
    - Established **Spec 035** for a Read/Write split pattern in `DatabaseService` and a tiered L1/L2/L3 caching strategy.
    - Outlined the migration path from Free Tier (Render/Supabase) to Hyperscale (Kubernetes/Citus) without requiring code rewrites.
- **Edge-First Mesh Discovery:**
    - Proposed a local-first mesh architecture (**ADR 052**) using **mDNS** for automatic service discovery during internet outages.
    - Updated the hardware onboarding strategy (**Spec 009**) to utilize auto-discovery handshakes, removing the need for manual IP configuration.
- **User Invitation System:**
    - Established the `invitations` table and domain logic for organization-scoped invites.
    - Built a robust workflow: Admin sends invite -> System generates UUID token -> Background job (BullMQ) sends high-fidelity email -> User joins via `/register?token=...`.
    - Added `InvitationManager` component in `@sous/features` for tracking and revoking pending invites.
- **Account Recovery & UI Foundations:**
    - Implemented secure **Forgot Password** and **Reset Password** flows using short-lived tokens.
    - Built `ForgotPasswordForm` and `ResetPasswordForm` with modern, brand-aligned aesthetics.
    - Refactored `RegisterForm` to support invitation pre-filling and social signup.
- **Bug Fixes & Technical Debt:**
    - Resolved Next.js font loader errors by migrating variable constants to explicit literals in root layouts.
    - Fixed `useAuth` hook to export the `register` method, enabling registration from the new UI.
    - Stabilized `CoreModule` by dynamically resolving BullMQ/Redis connections from the centralized `@sous/config` package.
    - Hardened `@sous/emails` build pipeline by resolving missing React types and misconfigured TS inheritance.
    - Synchronized database schema across all environments via `db:push`.

## 2026-02-13 (Recipe Cook Mode, Inline UX, and Screen Designer Polish)

- **Recipe Cook Mode:**
    - Implemented a high-readability, full-screen "Execution Protocol" view (`/cook`) optimized for tablets.
    - Integrated browser **Wake Lock API** to keep screens active during culinary operations.
    - Built a **Baker's Math & Scaling Engine**: users can lock a specific ingredient weight or target yield, and the system automatically recalculates the entire formula.
    - Added interactive **Phase Timers** that can be triggered directly from the instruction steps.
- **Inline Recipe Editing:**
    - Refactored `RecipeDetailPage` into a seamless inline form.
    - Created `InlineInput` and `InlineTextArea` components in `@sous/ui` that mimic static text until hovered or focused.
    - Implemented a "Commit Changes" FAB (Floating Action Button) that appears only when the recipe state is dirty.
- **Screen Designer Enhancements:**
    - Renamed "Library" to "Layout Design" for clarity.
    - Added an **"Editor vs. Preview"** toggle to the canvas, allowing designers to view a 1:1 representation of the final output.
    - Enabled **Hierarchy Reparenting**: users can now drag-and-drop elements within the tree view to change their parents.
    - Forced floating elements to remain children of the root Flex container to prevent layout fragmentation.
    - Resolved an "Internal Server Error" during sync by sanitizing and stringifying complex JSON structures before database insertion.
- **Dev & Infrastructure:**
    - Refined Android Emulator startup logic in `device-manager.ts` to fallback to standard Windows SDK paths when environment variables are missing.
    - Fixed Dashboard Metrics rendering by handling bigint-to-string conversion in Postgres aggregations.
    - Implemented `sous context login-as <orgId>` CLI command for rapid cross-organizational debugging.

## 2026-02-12 (Dashboard Metrics & OrderManager Implementation)

... (rest of the file) ...
