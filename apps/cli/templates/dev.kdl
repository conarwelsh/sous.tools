layout {
    default_tab_template {
        pane size=1 borderless=true {
            plugin location="zellij:tab-bar"
        }
        children
        pane size=2 borderless=true {
            plugin location="zellij:status-bar"
        }
    }
    tab name="sous.tools" focus=true {
        pane split_direction="vertical" {
            // Left Column: Gemini (Top), Shell (Bottom)
            pane size="60%" split_direction="horizontal" {
                pane name="Gemini" {
                    command "gemini"
                }
                pane name="Shell"
            }
            // Right Column: API (Top), Web (Middle), Services (Bottom Stacked)
            pane size="40%" split_direction="horizontal" {
                pane name="API (@sous/api)" {
                    command "bash"
                    args "-c" "while true; do pnpm dev --filter @sous/api 2>&1 | tee -a $HOME/.sous/logs/combined.log; echo; echo 'Process exited. Press any key to restart...'; read -n 1 -s -r; echo; done"
                }
                pane name="Web (@sous/web)" {
                    command "bash"
                    args "-c" "while true; do pnpm dev --filter @sous/web 2>&1 | tee -a $HOME/.sous/logs/combined.log; echo; echo 'Process exited. Press any key to restart...'; read -n 1 -s -r; echo; done"
                }
                pane name="Services" stacked=true {
                    pane name="Docs" start_suspended=true {
                        command "bash"
                        args "-c" "while true; do pnpm dev --filter @sous/docs 2>&1 | tee -a $HOME/.sous/logs/combined.log; echo; echo 'Process exited. Press any key to restart...'; read -n 1 -s -r; echo; done"
                    }
                    pane name="WearOS" start_suspended=true {
                        command "bash"
                        args "-c" "while true; do pnpm dev --filter @sous/wearos 2>&1 | tee -a $HOME/.sous/logs/combined.log; echo; echo 'Process exited. Press any key to restart...'; read -n 1 -s -r; echo; done"
                    }
                    pane name="Android" start_suspended=true {
                        command "bash"
                        args "-c" "while true; do pnpm cap:run:android --filter @sous/web 2>&1 | tee -a $HOME/.sous/logs/combined.log; echo; echo 'Process exited. Press any key to restart...'; read -n 1 -s -r; echo; done"
                    }
                    pane name="Remote Sync" start_suspended=true {
                        command "bash"
                        args "-c" "while true; do pnpm sous native sync --pi --watch 2>&1 | tee -a $HOME/.sous/logs/combined.log; echo; echo 'Sync exited. Press any key to restart...'; read -n 1 -s -r; echo; done"
                    }
                    pane name="Pi Logs" start_suspended=true {
                        command "bash"
                        args "-c" "while true; do pnpm sous logs rpi --follow 2>&1 | tee -a $HOME/.sous/logs/combined.log; echo; echo 'Log stream exited. Retrying in 5s...'; sleep 5; done"
                    }
                }
            }
        }
    }
}

themes {
    sous-tools {
        fg "#4cc9f0"
        bg "#0f172a"
        black "#1e293b"
        red "#f43f5e"
        green "#10b981"
        yellow "#f59e0b"
        blue "#2563eb"
        magenta "#f72585"
        cyan "#4cc9f0"
        white "#f8fafc"
        orange "#f97316"
    }
}

theme "sous-tools"
